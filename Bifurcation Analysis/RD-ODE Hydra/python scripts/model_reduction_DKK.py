import sympy as sp
from numpy import linalg as LA
import numpy as np
import matplotlib.pyplot as plt

Wl = sp.Symbol('Wl')
A = sp.Symbol('A')
Wd = sp.Symbol('Wd')
C = sp.Symbol('C')
b1 = sp.Symbol('b1')
b2 = sp.Symbol('b2')
b3 = sp.Symbol('b3')
b4 = sp.Symbol('b4')
b5 = sp.Symbol('b5')
b6 = sp.Symbol('b6')
a1 = sp.Symbol('a1')
a2 = sp.Symbol('a2')
a3 = sp.Symbol('a3')
a4 = sp.Symbol('a4')

beta = [1.0629, 540.4003, 1.1596, 11.5964, 11.5964, 4.8254]

##########################################################################################################
# Use QSSA for A, C and S:

def check_bistability_woACS():
    f_1 = b6*Wl*(1+b5*Wl)*(1+b4*Wl) / ((b1+b4*Wl+1)*(1+b3*Wl)*(1+b5*Wl+Wd)) - Wl
    f_2 = b2*Wl**2 - Wd

    U0_sols = [sp.Piecewise(
    (-0.0215584146804181*b1
        - 8.98871026760129e-16*sp.sqrt((-2.75923260729557e+40*b1**3 + 2.00022042399438e+41*b1**2 + 1.75381783958539e+42*b1 + (5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5*(1.15045298253893e+27*b1**2 - 5.55990228692623e+27*b1 + 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 1.42581807503722e+29) - 3.39157739210692e+43)/(5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5)
        + 3.6696256002232e-16*sp.sqrt(3.45135894761679e+27*b1**2 - 1.66797068607787e+28*b1 - 3.43337764435216e+15*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 4.27745422511165e+29)
        - 0.242514724836564,
    sp.Eq(9.20463750893292e+21*b1**2 + 1.32207745997327e+21*b1, -4.95105008229007e+22)),
    (-0.0215584146804181*b1
        + 8.98871026760129e-16*sp.sqrt((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 - (1.57216165040082e+28*b1 - 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)
            /((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)
        - 8.98871026760129e-16*sp.sqrt(-3.14432330080164e+28*b1 - 14.6969384566991*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)/((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 + (-1.57216165040082e+28*b1 + 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 + ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)**0.5 + 12.0*(9791377935625.0*b1 + 110145080750569.0)**2 - 2.06278509876276e+29*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 3.00145825887072e+27)
        - 0.242514724836564,
    True)
    ),
    sp.Piecewise(
    (-0.0215584146804181*b1
        + 8.98871026760129e-16*sp.sqrt((-2.75923260729557e+40*b1**3 + 2.00022042399438e+41*b1**2 + 1.75381783958539e+42*b1 + (5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5*(1.15045298253893e+27*b1**2 - 5.55990228692623e+27*b1 + 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 1.42581807503722e+29) - 3.39157739210692e+43)/(5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5)
        + 3.6696256002232e-16*sp.sqrt(3.45135894761679e+27*b1**2 - 1.66797068607787e+28*b1 - 3.43337764435216e+15*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 4.27745422511165e+29)
        - 0.242514724836564,
    sp.Eq(9.20463750893292e+21*b1**2 + 1.32207745997327e+21*b1, -4.95105008229007e+22)),
    (-0.0215584146804181*b1
        + 8.98871026760129e-16*sp.sqrt((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 - (1.57216165040082e+28*b1 - 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)
        + 8.98871026760129e-16*sp.sqrt(-3.14432330080164e+28*b1 - 14.6969384566991*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)/((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 + (-1.57216165040082e+28*b1 + 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 + ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)**0.5 + 12.0*(9791377935625.0*b1 + 110145080750569.0)**2 - 2.06278509876276e+29*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 3.00145825887072e+27)
        - 0.242514724836564,
    True)
    ),
    sp.Piecewise(
    (-0.0215584146804181*b1
        - 8.98871026760129e-16*sp.sqrt((2.75923260729557e+40*b1**3 - 2.00022042399438e+41*b1**2 - 1.75381783958539e+42*b1 + (5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5*(1.15045298253893e+27*b1**2 - 5.55990228692623e+27*b1 + 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 1.42581807503722e+29) + 3.39157739210692e+43)/(5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5)
        - 3.6696256002232e-16*sp.sqrt(3.45135894761679e+27*b1**2 - 1.66797068607787e+28*b1 - 3.43337764435216e+15*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 4.27745422511165e+29)
        - 0.242514724836564,
    sp.Eq(9.20463750893292e+21*b1**2 + 1.32207745997327e+21*b1, -4.95105008229007e+22)),
    (-0.0215584146804181*b1
        - 8.98871026760129e-16*sp.sqrt((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 - (1.57216165040082e+28*b1 - 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)
        - 8.98871026760129e-16*sp.sqrt(-3.14432330080164e+28*b1 + 14.6969384566991*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)/((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 + (-1.57216165040082e+28*b1 + 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 + ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)**0.5 + 12.0*(9791377935625.0*b1 + 110145080750569.0)**2 - 2.06278509876276e+29*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 3.00145825887072e+27)
        - 0.242514724836564,
    True)
    ),
    sp.Piecewise(
    (-0.0215584146804181*b1 
        + 8.98871026760129e-16*sp.sqrt((2.75923260729557e+40*b1**3 - 2.00022042399438e+41*b1**2 - 1.75381783958539e+42*b1 + (5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5*(1.15045298253893e+27*b1**2 - 5.55990228692623e+27*b1 + 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 1.42581807503722e+29) + 3.39157739210692e+43)/(5.75226491269465e+26*b1**2 - 2.77995114346312e+27*b1 - 572229607392027.0*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 7.12909037518608e+28)**0.5)
        - 3.6696256002232e-16*sp.sqrt(3.45135894761679e+27*b1**2 - 1.66797068607787e+28*b1 - 3.43337764435216e+15*(-4.73846412846205e+39*b1**3 + 2.1527878005611e+39*b1**2 - 6.31885076125324e+40*b1 + 4.92611988531704e+40)**0.333333333333333 + 4.27745422511165e+29)
        - 0.242514724836564,
    sp.Eq(9.20463750893292e+21*b1**2 + 1.32207745997327e+21*b1, -4.95105008229007e+22)),
    (-0.0215584146804181*b1 
        - 8.98871026760129e-16*sp.sqrt((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 - (1.57216165040082e+28*b1 - 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)
        + 8.98871026760129e-16*sp.sqrt(-3.14432330080164e+28*b1 + 14.6969384566991*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)/((5.69615672788189e+55*b1**2 + 8.18148505152896e+54*b1 + (-1.57216165040082e+28*b1 + 6.0*(9791377935625.0*b1 + 110145080750569.0)**2 + ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 1.50072912943536e+27)*((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 + 3.06388569989283e+56)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333)**0.5 + 12.0*(9791377935625.0*b1 + 110145080750569.0)**2 - 2.06278509876276e+29*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)/((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - ((-8.77732049380261e+87*(2.76139125267987e+26*b1**2 + 3.96623237991981e+25*b1 + 1.48531502468702e+27)**3 + (-(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 + 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) - 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**2)**0.5 + (7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)**3 - 9.0*(7.86080825200409e+27*b1 - 3.0*(9791377935625.0*b1 + 110145080750569.0)**2 + 7.50364564717679e+26)*(-2.75737930215149e+52*b1**4 + 2.66516923692471e+53*b1**3 + 1.15084423255008e+55*b1**2 + 3.57580332510937e+55*b1 - 3.21403223149996e+56) + 27.0*(1.87741999153427e+39*b1**3 - 1.36097761441101e+40*b1**2 - 1.19332189132627e+41*b1 + 2.3076761205059e+42)**2)**0.333333333333333 - 3.00145825887072e+27)
        - 0.242514724836564,
    True))]

    f1_val = f_1.subs({b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f2_val = f_2.subs({b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    j11 = sp.diff(f1_val, Wl)
    j12 = sp.diff(f1_val, Wd)
    j21 = sp.diff(f2_val, Wl)
    j22 = sp.diff(f2_val, Wd)

    for beta1_val in np.linspace(3.7, 4.0, 100):
        sols = []
        for pw in U0_sols:
            sol = pw.subs(b1, beta1_val)
            if isinstance(sol, sp.Piecewise):
                for expr, cond in sol.args:
                    if cond == True:
                        if np.abs(sp.im(expr.evalf())) < 10**(-13) and sp.re(expr.evalf()) >= 0:
                            sols.append(sp.re(expr.evalf()))
                            j11_val = j11.subs({b1: beta1_val, Wl: sp.re(expr.evalf()), Wd: beta[1]*sp.re(expr.evalf())**2})
                            j12_val = j12.subs({b1: beta1_val, Wl: sp.re(expr.evalf()), Wd: beta[1]*sp.re(expr.evalf())**2})
                            j21_val = j21.subs({b1: beta1_val, Wl: sp.re(expr.evalf()), Wd: beta[1]*sp.re(expr.evalf())**2})
                            j22_val = j22.subs({b1: beta1_val, Wl: sp.re(expr.evalf()), Wd: beta[1]*sp.re(expr.evalf())**2})
                            trace = j11_val + j22_val
                            determinant = j11_val*j22_val - j12_val*j21_val
                            if trace < 0 and determinant > 0:
                                if j11_val > 0: # DDI:
                                    plt.plot(beta1_val, sp.re(expr.evalf()), 'ro', markersize=4)
                                else:
                                    plt.plot(beta1_val, sp.re(expr.evalf()), 'bo', markersize=4)
                            else:
                                plt.plot(beta1_val, sp.re(expr.evalf()), 'go', markersize=4)
            else:
                if np.abs(sp.im(sol.evalf())) < 10**(-13) and sp.re(sol.evalf()) >= 0:
                    sols.append(sp.re(sol.evalf()))
                    j11_val = j11.subs({b1: beta1_val, Wl: sp.re(sol.evalf()), Wd: beta[1]*sp.re(sol.evalf())**2})
                    j12_val = j12.subs({b1: beta1_val, Wl: sp.re(sol.evalf()), Wd: beta[1]*sp.re(sol.evalf())**2})
                    j21_val = j21.subs({b1: beta1_val, Wl: sp.re(sol.evalf()), Wd: beta[1]*sp.re(sol.evalf())**2})
                    j22_val = j22.subs({b1: beta1_val, Wl: sp.re(sol.evalf()), Wd: beta[1]*sp.re(sol.evalf())**2})
                    trace = j11_val + j22_val
                    determinant = j11_val*j22_val - j12_val*j21_val
                    if trace < 0 and determinant > 0:
                        if j11_val > 0: # DDI:
                            plt.plot(beta1_val, sp.re(sol.evalf()), 'ro', markersize=4)
                        else:
                            plt.plot(beta1_val, sp.re(sol.evalf()), 'bo', markersize=4)
                    else:
                        plt.plot(beta1_val, sp.re(sol.evalf()), 'go', markersize=4)
        
        j11_val = j11.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        j12_val = j12.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        j21_val = j21.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        j22_val = j22.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        trace = j11_val + j22_val
        determinant = j11_val*j22_val - j12_val*j21_val
        if trace < 0 and determinant > 0:
            if j11_val > 0: # DDI:
                plt.plot(beta1_val, 0.0, 'ro', markersize=4)
            else:
                plt.plot(beta1_val, 0.0, 'bo', markersize=4)
        else:
            plt.plot(beta1_val, 0.0, 'go', markersize=4)
    plt.xlabel('beta1')
    plt.ylabel('Wl steady states')
    plt.show()

def investigate_DDI_woACS():
    f_1 = b6*Wl*(1+b5*Wl)*(1+b4*Wl) / ((b1+b4*Wl+1)*(1+b3*Wl)*(1+b5*Wl+Wd)) - Wl
    f_2 = b2*Wl**2 - Wd

    # sp.simplify(b6*Wl*(1+b5*Wl)*(1+b4*Wl) / ((b1+b4*Wl+1)*(1+b3*Wl)*(1+b5*Wl+Wd))-Wl) 
    # Derivative with respect to Wl and Wd:
    j11 = sp.diff(f_1, Wl)
    # j11 = sp.simplify(-Wl*b3*b6*(Wl*b4 + 1)*(Wl*b5 + 1)/((Wl*b3 + 1)**2*(Wd + Wl*b5 + 1)*(Wl*b4 + b1 + 1)) - Wl*b4*b6*(Wl*b4 + 1)*(Wl*b5 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)*(Wl*b4 + b1 + 1)**2) + Wl*b4*b6*(Wl*b5 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)*(Wl*b4 + b1 + 1)) - Wl*b5*b6*(Wl*b4 + 1)*(Wl*b5 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)**2*(Wl*b4 + b1 + 1)) + Wl*b5*b6*(Wl*b4 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)*(Wl*b4 + b1 + 1)) + b6*(Wl*b4 + 1)*(Wl*b5 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)*(Wl*b4 + b1 + 1)) - 1)
    j12 = sp.diff(f_1, Wd)
    # j12 = sp.simplify(-Wl*b6*(Wl*b4 + 1)*(Wl*b5 + 1)/((Wl*b3 + 1)*(Wd + Wl*b5 + 1)**2*(Wl*b4 + b1 + 1)))
    j21 = sp.diff(f_2, Wl)
    j22 = sp.diff(f_2, Wd)

    U0 = [0.08167547924306925, 0.54587711524379, 3.6049476660047937, 1.8514050545898464, 0.08167547924306925]

    f_1_eval = f_1.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_2_eval = f_2.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})

    print(f"Test steady state: {f_1_eval.subs({Wl: U0[0], Wd: U0[2]})} and {f_2_eval.subs({Wl: U0[0], Wd: U0[2]})}")

    print(f"Jacobian: ")
    Jac = [[j11.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5], Wl: U0[0], Wd: U0[2]}), j12.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5], Wl: U0[0], Wd: U0[2]})],
        [j21.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5], Wl: U0[0], Wd: U0[2]}), j22.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5], Wl: U0[0], Wd: U0[2]})]]

    print(Jac)
    print(f"Autocatalyse: {Jac[0][0]}")
    print(f"Determinant: {Jac[0][0]*Jac[1][1] - Jac[0][1]*Jac[1][0]}")
    print(f"Trace: {Jac[0][0] + Jac[1][1]}")

def find_simpler_bistability():
    # g1 = -Wl + 5.0*Wl*(Wl+1)/((Wl + b1)*(0.1*Wd + 1.0))
    g1 = -Wl + b1*Wl*(Wl+1)/((0.2*Wl + 1.0)*(0.1*Wd + 1.0))  # np.linspace(3.75, 6.0, 200)
    # g1 = -Wl + b1*Wl**2/((Wd + 1.0))
    g2 = -Wd + 4.0*Wl**2
    g_st = g1.subs(Wd, 4.0*Wl**2)

    j11 = sp.diff(g1, Wl)
    j12 = sp.diff(g1, Wd)
    j21 = sp.diff(g2, Wl)
    j22 = sp.diff(g2, Wd)

    trace = j11 + j22
    determinant = j11*j22 - j12*j21

    # U0_list = sp.solve(g_st, Wl)
    # U0_list = [0.0,
    #            sp.Piecewise((-0.25*b1 - 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                          - 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 0.666666666666667)
    #                          - 25.3125,
    #                          sp.Eq(831.192708333333*b1**2 - 555.848958333333*b1, -4956.19270833333)),
    #                         (-0.25*b1 - 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                           - 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.666666666666667)
    #                           - 25.3125,
    #                          True)
    #             ),
    #            sp.Piecewise((-0.25*b1 - 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                          + 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 0.666666666666667)
    #                          - 25.3125,
    #                          sp.Eq(831.192708333333*b1**2 - 555.848958333333*b1, -4956.19270833333)),
    #                         (-0.25*b1 - 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                           + 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.666666666666667)
    #                           - 25.3125,
    #                          True)
    #             ),
    #            sp.Piecewise((-0.25*b1 + 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                          - 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 0.666666666666667)
    #                          - 25.3125,
    #                          sp.Eq(831.192708333333*b1**2 - 555.848958333333*b1, -4956.19270833333)),
    #                         (-0.25*b1 + 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                           - 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.666666666666667)
    #                           - 25.3125,
    #                          True)
    #             ),
    #            sp.Piecewise((-0.25*b1 + 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                          + 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 2.0*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 0.666666666666667)
    #                          - 25.3125,
    #                          sp.Eq(831.192708333333*b1**2 - 555.848958333333*b1, -4956.19270833333)),
    #                         (-0.25*b1 + 0.5*sp.sqrt(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)
    #                           + 0.5*sp.sqrt(-133.666666666667*b1 + 0.5*(b1 + 101.25)**2 + 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - (0.25*b1**3 - 24.3125*b1**2 - 2411.640625*b1 + 259042.55078125)/(-66.8333333333333*b1 + 0.25*(b1 + 101.25)**2 - 0.666666666666667*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)/((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 + 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.333333333333333)**0.5 - 2.0*((0.037037037037037*(-831.192708333333*b1**2 + 555.848958333333*b1 - 4956.19270833333)**3 + 0.25*(-0.00925925925925926*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 + 0.333333333333333*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) - 0.125*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**2)**0.5 + 0.00462962962962963*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)**3 - 0.166666666666667*(100.25*b1 - 0.375*(b1 + 101.25)**2 + 0.5)*(-0.01171875*b1**4 + 1.51953125*b1**3 + 541.69482421875*b1**2 + 15019.6945800781*b1 - 1226300.03349304) + 0.0625*(0.125*b1**3 - 12.15625*b1**2 - 1205.8203125*b1 + 129521.275390625)**2)**0.333333333333333 - 0.666666666666667)
    #                           - 25.3125,
    #                          True))
    #           ]

    for beta1_val in np.linspace(3.0/5.0, 10.0/5.0, 200):
        # sols = []
        # for pw in U0_list:
        #     if type(pw) != float:
        #         sol = pw.subs(b1, beta1_val)
        #         if isinstance(sol, sp.Piecewise):
        #             for expr, cond in sol.args:
        #                 if cond == True:
        #                     sols.append(expr.evalf())
        #         else:
        #             sols.append(sol.evalf())
        #     else:
        #         sols.append(pw)
        g_st_eval = g_st.subs({b1: beta1_val})
        sols = sp.solve(g_st_eval, Wl)
        for sol in sols:
            if np.abs(sp.im(sol)) < 10**(-17) and sp.re(sol) >= 0:
                trace_val = trace.subs({b1: beta1_val, Wl: sp.re(sol), Wd: 4.0*sp.re(sol)**2})
                det_val = determinant.subs({b1: beta1_val, Wl: sp.re(sol), Wd: 4.0*sp.re(sol)**2})
                j11_val = j11.subs({b1: beta1_val, Wl: sp.re(sol), Wd: 4.0*sp.re(sol)**2})
                if trace_val < 0 and det_val > 0:
                    if j11_val > 0: # DDI:
                        plt.plot(beta1_val, sp.re(sol), 'ro', markersize=4)
                    else: # always stable:
                        plt.plot(beta1_val, sp.re(sol), 'bo', markersize=4)
                else: # unstable:
                    plt.plot(beta1_val, sp.re(sol), 'go', markersize=4)
        
        # trace_val = trace.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        # det_val = determinant.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        # j11_val = j11.subs({b1: beta1_val, Wl: 0.0, Wd: 0.0})
        # if trace_val < 0 and det_val > 0:
        #     if j11_val > 0: # DDI:
        #         plt.plot(beta1_val, 0.0, 'ro', markersize=4)
        #     else:
        #         plt.plot(beta1_val, 0.0, 'bo', markersize=4)
        # else:
        #     plt.plot(beta1_val, 0.0, 'go', markersize=4)
    plt.xlabel('beta1')
    plt.ylabel('Wl simplf model v2')
    plt.show()

            
def check_DDI(b=6.0):
    g1 = -Wl + b*Wl**2/((Wd + 1.0))
    g2 = -Wd + 4.0*Wl**2
    g_st = g1.subs(Wd, 4.0*Wl**2)
    sols = sp.solve(g_st, Wl)
    for sol in sols:
        print(f"Steady state Wl: {sol}")
        if np.abs(sp.im(sol)) < 10**(-17) and sp.re(sol) >= 0:
            sol = sp.re(sol)
            j11 = sp.diff(g1, Wl).subs({Wl: sol, Wd: 4.0*sol**2})
            j12 = sp.diff(g1, Wd).subs({Wl: sol, Wd: 4.0*sol**2})
            j21 = sp.diff(g2, Wl).subs({Wl: sol, Wd: 4.0*sol**2})
            j22 = sp.diff(g2, Wd).subs({Wl: sol, Wd: 4.0*sol**2})
            trace = j11 + j22
            determinant = j11*j22 - j12*j21
            if trace < 0 and determinant > 0:
                if j11 > 0:
                    print(f"  --> DDI stable steady state with j11: {j11}, trace: {trace}, determinant: {determinant}")
                else:
                    print(f"  --> stable steady state with j11: {j11}, trace: {trace}, determinant: {determinant}")
            else:
                print(f"  --> unstable steady state with j11: {j11}, trace: {trace}, determinant: {determinant}")

############################################################################################################
# Kickout A (without QSSA) and use QSSA for S:

def investigate_DDI_woAS():
    f_1 = b6*Wl / ((1 + C)*(1+b3*Wl)) - Wl
    f_2 = b2*Wl**2 - Wd
    f_3 = Wd / (1 + b5*Wl) - C

    # Calculate steady states (Can change as we do not use QSSA to eliminate A):
    f_1_eval = f_1.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_2_eval = f_2.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_3_eval = f_3.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})    

    j11 = sp.diff(f_1_eval, Wl)
    j12 = sp.diff(f_1_eval, Wd)
    j13 = sp.diff(f_1_eval, C)
    j21 = sp.diff(f_2_eval, Wl)
    j22 = sp.diff(f_2_eval, Wd)
    j23 = sp.diff(f_2_eval, C)
    j31 = sp.diff(f_3_eval, Wl)
    j32 = sp.diff(f_3_eval, Wd)
    j33 = sp.diff(f_3_eval, C)

    # U0 = sp.solve([f_1_eval, f_2_eval, f_3_eval], (Wl, Wd, C))
    U0 = [(0.0, 0.0, 0.0),
        (-0.949651529657360, 487.353540764025 + 1.73472347597681e-18*sp.I, -48.6743213520697 + 0.e-23*sp.I),
        (0.119581860849170, 7.72762779836518 + 2.71050543121376e-20*sp.I, 3.2377617571398 + 0.e-19*sp.I),
        (-0.0537555718163929, 1.56157394220495 + 6.7762635780344e-21*sp.I, 4.14618739070092 + 0.e-19*sp.I)]
    U0 = [0.119581860849170, 7.72762779836518, 3.2377617571398]

    print(f"Test steady state: {f_1_eval.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})} and {f_2_eval.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})} and {f_3_eval.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})}")

    Jac_eval = [[j11.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j12.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j13.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})],
                [j21.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j22.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j23.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})],
                [j31.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j32.subs({Wl: U0[0], Wd: U0[1], C: U0[2]}), j33.subs({Wl: U0[0], Wd: U0[1], C: U0[2]})]]
    print(f"Jacobian: {Jac_eval}")
    print(f"Autocatalysis: {Jac_eval[0][0]}")
    Jac_float = [[float(Jac_eval[0][0]), float(Jac_eval[0][1]), float(Jac_eval[0][2])],
                [float(Jac_eval[1][0]), float(Jac_eval[1][1]), float(Jac_eval[1][2])],
                [float(Jac_eval[2][0]), float(Jac_eval[2][1]), float(Jac_eval[2][2])]]
    print(f"Eigenvalues Jacobian: {LA.eigvals(Jac_float)}")
    print(f"J12 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][1])],
                                        [float(Jac_eval[1][0]), float(Jac_eval[1][1])]])}")
    print(f"J13 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][2])],
                                        [float(Jac_eval[2][0]), float(Jac_eval[2][2])]])}")
    print(f"J23 eigenvalues: {LA.eigvals([[float(Jac_eval[1][1]), float(Jac_eval[1][2])],
                                        [float(Jac_eval[2][1]), float(Jac_eval[2][2])]])}")

alpha = [1.5, 1.2, 1.5, 4.0] #[4.2, 1.8, 10.5, 10.0]
def investigate_DDI_woAS_v2():
    f_1 = a4*Wd / ((1 + C)*(1+a2*Wl)) - Wl
    expr_Wd = a1*Wl**2
    f_2 = expr_Wd - Wd
    expr_C = Wd / (1 + a3*Wl)
    f_3 = expr_C - C

    j11 = sp.diff(f_1, Wl)
    j12 = sp.diff(f_1, Wd)
    j13 = sp.diff(f_1, C)
    j21 = sp.diff(f_2, Wl)
    j22 = sp.diff(f_2, Wd)
    j23 = sp.diff(f_2, C)
    j31 = sp.diff(f_3, Wl)
    j32 = sp.diff(f_3, Wd)
    j33 = sp.diff(f_3, C)

    trace = j11 + j22 + j33
    determinant = (j11*j22*j33 + j12*j23*j31 + j13*j21*j32
                   - j13*j22*j31 - j12*j21*j33 - j11*j23*j32)
    p2 = j11*j22 - j12*j21 + j11*j33 - j13*j31 + j22*j33 - j23*j32
    detJ12 = j11*j22 - j12*j21

    # To calculate steady states, reformulate problem to g_st(Wl) = 0:
    g_st = f_1.subs({C: expr_C}).simplify()
    g_st = g_st.subs({Wd: expr_Wd}).simplify()
    g_st = g_st.subs({a2: alpha[1], a3: alpha[2], a4: alpha[3]})

    # #####
    # g_st = g_st.subs(a1, alpha[0])
    # sols = sp.solve(g_st, Wl)
    # for sol in sols:
    #     if np.abs(sp.im(sol)) < 10**(-17) and sp.re(sol) >= 0:
    #         print(f"Steady state Wl: {sol}, Wd: {(a1*sp.re(sol)**2).subs(a1, alpha[0])}, C: {(a1*sp.re(sol)**2/(1 + a3*sp.re(sol))).subs({a1: alpha[0], a3: alpha[2]})}")
    #         j11_val = j11.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j12_val = j12.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j13_val = j13.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j21_val = j21.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j22_val = j22.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j23_val = j23.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j31_val = j31.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j32_val = j32.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         j33_val = j33.subs({Wl: sp.re(sol), Wd: a1*sp.re(sol)**2, C: a1*sp.re(sol)**2/(1 + a3*sp.re(sol)), a1:alpha[0], a2: alpha[1], a3: alpha[2], a4: alpha[3]})
    #         print(f"Jacobian at steady state: [[{j11_val}, {j12_val}, {j13_val}], [{j21_val}, {j22_val}, {j23_val}], [{j31_val}, {j32_val}, {j33_val}]]")
    # #####

    trace = trace.subs({C: expr_C, Wd: expr_Wd})
    determinant = determinant.subs({C: expr_C, Wd: expr_Wd})
    detJ12 = detJ12.subs({C: expr_C, Wd: expr_Wd})
    p2 = p2.subs({C: expr_C, Wd: expr_Wd})
    trace = trace.subs({C: expr_C, Wd: expr_Wd, a2: alpha[1], a3: alpha[2], a4: alpha[3]}).simplify()
    determinant = determinant.subs({C: expr_C, Wd: expr_Wd, a2: alpha[1], a3: alpha[2], a4: alpha[3]}).simplify()
    detJ12 = detJ12.subs({C: expr_C, Wd: expr_Wd, a2: alpha[1], a3: alpha[2], a4: alpha[3]}).simplify()
    p2 = p2.subs({C: expr_C, Wd: expr_Wd, a2: alpha[1], a3: alpha[2], a4: alpha[3]}).simplify()

    counter_DDI = 0
    counter_stable = 0
    counter_unstable = 0
    for alpha_val in np.linspace(0.1, 5.0, 100):
        g_st_eval = g_st.subs({a1: alpha_val})
        sols = sp.solve(g_st_eval, Wl)
        for sol in sols:
            if np.abs(sp.im(sol)) < 10**(-17) and sp.re(sol) >= 0:
                trace_val = trace.subs({Wl: sp.re(sol), a1: alpha_val})
                det_val = determinant.subs({Wl: sp.re(sol), a1: alpha_val})
                p2_val = p2.subs({Wl: sp.re(sol), a1: alpha_val})
                detJ12_val = detJ12.subs({Wl: sp.re(sol), a1: alpha_val})
                if trace_val < 0 and det_val < 0 and -trace_val*p2_val + det_val > 0:
                    if detJ12_val < 0: # DDI:
                        if counter_DDI == 0:
                            label = 'DDI'
                        else:
                            label = None
                        counter_DDI += 1
                        plt.plot(alpha_val, sp.re(sol), 'ro', markersize=4, label=label)
                    else: # always stable:
                        if counter_stable == 0:
                            label = 'Stable'
                        else:
                            label = None
                        counter_stable += 1
                        plt.plot(alpha_val, sp.re(sol), 'bo', markersize=4, label=label)
                else: # unstable:
                    if counter_unstable == 0:
                            label = 'Unstable'
                    else:
                        label = None
                    counter_unstable += 1
                    plt.plot(alpha_val, sp.re(sol), 'go', markersize=4, label=label)
    plt.xlabel('alpha1')
    plt.ylabel('Wl v2')
    plt.legend()
    plt.show()

############################################################################################################
# Kickout S using QSSA:

def investigate_DDI_woS():
    f_1 = b6*Wl / ((1 + A)*(1 + C)*(1+b3*Wl)) - Wl
    f_2 = b1 / (1 + b4*Wl) - A
    f_3 = b2*Wl**2 - Wd
    f_4 = Wd / (1 + b5*Wl) - C

    U0 = [0.08167547924306925, 0.54587711524379, 3.6049476660047937, 1.8514050545898464, 0.08167547924306925]

    f_1_eval = f_1.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_2_eval = f_2.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_3_eval = f_3.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})
    f_4_eval = f_4.subs({b1: beta[0], b2: beta[1], b3: beta[2], b4: beta[3], b5: beta[4], b6: beta[5]})

    print(f"Test steady state: {f_1_eval.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})} and {f_2_eval.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})} and {f_3_eval.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})} and {f_4_eval.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})}")

    j11 = sp.diff(f_1_eval, Wl)
    j12 = sp.diff(f_1_eval, A)
    j13 = sp.diff(f_1_eval, Wd)
    j14 = sp.diff(f_1_eval, C)
    j21 = sp.diff(f_2_eval, Wl)
    j22 = sp.diff(f_2_eval, A)
    j23 = sp.diff(f_2_eval, Wd)
    j24 = sp.diff(f_2_eval, C)
    j31 = sp.diff(f_3_eval, Wl)
    j32 = sp.diff(f_3_eval, A)
    j33 = sp.diff(f_3_eval, Wd)
    j34 = sp.diff(f_3_eval, C)
    j41 = sp.diff(f_4_eval, Wl)
    j42 = sp.diff(f_4_eval, A)
    j43 = sp.diff(f_4_eval, Wd)
    j44 = sp.diff(f_4_eval, C)

    Jac_eval = [[j11.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j12.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j13.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j14.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})],
                [j21.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j22.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j23.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j24.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})],
                [j31.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j32.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j33.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j34.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})],
                [j41.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j42.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j43.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]}), j44.subs({Wl: U0[0], A: U0[1], Wd: U0[2], C: U0[3]})]]
    print(f"Jacobian: {Jac_eval}")
    print(f"Autocatalysis: {Jac_eval[0][0]}")
    Jac_float = [[float(Jac_eval[0][0]), float(Jac_eval[0][1]), float(Jac_eval[0][2]), float(Jac_eval[0][3])],
                [float(Jac_eval[1][0]), float(Jac_eval[1][1]), float(Jac_eval[1][2]), float(Jac_eval[1][3])],
                [float(Jac_eval[2][0]), float(Jac_eval[2][1]), float(Jac_eval[2][2]), float(Jac_eval[2][3])],
                [float(Jac_eval[3][0]), float(Jac_eval[3][1]), float(Jac_eval[3][2]), float(Jac_eval[3][3])]]
    print(f"Eigenvalues Jacobian: {LA.eigvals(Jac_float)}")
    print(f"J12 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][1])],
                                        [float(Jac_eval[1][0]), float(Jac_eval[1][1])]])}")
    print(f"J13 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][2])],
                                        [float(Jac_eval[2][0]), float(Jac_eval[2][2])]])}")
    print(f"J14 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][3])],
                                        [float(Jac_eval[3][0]), float(Jac_eval[3][3])]])}")
    print(f"J23 eigenvalues: {LA.eigvals([[float(Jac_eval[1][1]), float(Jac_eval[1][2])],
                                        [float(Jac_eval[2][1]), float(Jac_eval[2][2])]])}")
    print(f"J24 eigenvalues: {LA.eigvals([[float(Jac_eval[1][1]), float(Jac_eval[1][3])],
                                        [float(Jac_eval[3][1]), float(Jac_eval[3][3])]])}")
    print(f"J34 eigenvalues: {LA.eigvals([[float(Jac_eval[2][2]), float(Jac_eval[2][3])],
                                        [float(Jac_eval[3][2]), float(Jac_eval[3][3])]])}")
    print(f"J123 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][1]), float(Jac_eval[0][2])],
                                        [float(Jac_eval[1][0]), float(Jac_eval[1][1]), float(Jac_eval[1][2])],
                                        [float(Jac_eval[2][0]), float(Jac_eval[2][1]), float(Jac_eval[2][2])]])}")
    print(f"J124 eigenvalues: {LA.eigvals([[float(Jac_eval[0][0]), float(Jac_eval[0][1]), float(Jac_eval[0][3])],
                                        [float(Jac_eval[1][0]), float(Jac_eval[1][1]), float(Jac_eval[1][3])],
                                        [float(Jac_eval[3][0]), float(Jac_eval[3][1]), float(Jac_eval[3][3])]])}")
    print(f"J234 eigenvalues: {LA.eigvals([[float(Jac_eval[1][1]), float(Jac_eval[1][2]), float(Jac_eval[1][3])],
                                        [float(Jac_eval[2][1]), float(Jac_eval[2][2]), float(Jac_eval[2][3])],
                                        [float(Jac_eval[3][1]), float(Jac_eval[3][2]), float(Jac_eval[3][3])]])}")


#############################################################################################################

# Use QSSA for A, C and S:
# print("QSSA for A, C, S:")
# find_simpler_bistability()
# check_bistability_woACS()
# investigate_DDI_woACS()
# print(" ")

# Kickout A (without QSSA) and use QSSA for S:
# print("Kickout A and QSSA for S:")
# investigate_DDI_woAS()
investigate_DDI_woAS_v2()
# print(" ")

# Kickout S using QSSA:
# print("QSSA for S:")
# investigate_DDI_woS()
# print(" ")